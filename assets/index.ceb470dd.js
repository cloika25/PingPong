var y=Object.defineProperty;var x=(h,t,e)=>t in h?y(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var s=(h,t,e)=>(x(h,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(l){if(l.ep)return;l.ep=!0;const a=e(l);fetch(l.href,a)}})();const g=`
  <button id="continue">\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C</button>
  <button id="changeBallColor">\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0446\u0432\u0435\u0442 \u043C\u044F\u0447\u0430</button>
  <button id="changeBackgroundColor">\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0446\u0432\u0435\u0442 \u0444\u043E\u043D\u0430</button>
`;class w{constructor(){s(this,"boxWidth",800);s(this,"boxHeight",500);s(this,"boxRound",20);s(this,"boxColor","#333333");s(this,"lineWidth",6);s(this,"lineColor","#232323");s(this,"textColor","#EBEBEB");s(this,"supportColorRed","#FA0556");s(this,"supportColorYellow","#FAC405");s(this,"ballSpeed",7);s(this,"ballRadius",8);s(this,"ballXDefault",this.boxWidth/2);s(this,"ballYDefault",this.boxHeight/2);s(this,"ballColor","#EBEBEB");s(this,"ballHitScore",0);s(this,"ball");s(this,"playerRadius",7);s(this,"playerHeight",80);s(this,"playerSpeed",8);s(this,"playerBorder",this.playerRadius*3);s(this,"playerSpace",this.playerRadius*6);s(this,"playerYDefault",this.boxHeight/2-this.playerHeight/2);s(this,"playerL");s(this,"playerR");s(this,"drawYellow");this.ball={x:this.ballXDefault,y:this.ballYDefault,dy:0,dx:0,speed:this.ballSpeed},this.playerL={score:0,goalPointX:this.boxWidth-this.playerSpace*2,align:"left",x:this.playerSpace,y:this.playerYDefault,yDefault:this.boxHeight/2-this.playerHeight/2,color:"#A55F02",keys:[[87,"up"],[83,"down"]]},this.playerR={score:0,goalPointX:this.playerSpace*2,align:"left",x:this.boxWidth-this.playerSpace,y:this.playerYDefault,yDefault:this.boxHeight/2-this.playerHeight/2,color:"#38887A",keys:[[38,"up"],[40,"down"]]},this.drawYellow=!1}}class f{constructor(t){s(this,"game");s(this,"set");s(this,"ball");s(this,"print");this.game=t,this.set=t.set,this.ball=t.set.ball,this.print=t.print}getRandom(){return Math.random()*(1-.8)+.8}getRandomDirection(){return Boolean(Math.round(Math.random()))?this.getRandom():-this.getRandom()}dropBall(t){switch(this.ball.dx=this.getRandomDirection(),this.ball.dy=this.getRandomDirection(),t){case"left":this.ball.dx=Math.abs(this.ball.dx);break;case"right":this.ball.dx=-Math.abs(this.ball.dx);break}}move(){this.ball.x+=this.ball.dx*this.ball.speed,this.ball.y+=this.ball.dy*this.ball.speed}checkCollisionWithWalls(){let t=this.ball.x+this.ball.dx,e=this.ball.y+this.ball.dy;const i=this.set.boxWidth-this.set.ballRadius,l=this.set.ballRadius,a=this.set.ballRadius,o=this.set.boxHeight-this.set.ballRadius;t>=i&&(this.ball.dx=this.reverseBall(this.ball.dx),this.goalProcess(this.set.playerL)),t<=l&&(this.ball.dx=this.reverseBall(this.ball.dx),this.goalProcess(this.set.playerR)),(e>=o||e<=a)&&(this.ball.dy=this.reverseBall(this.ball.dy))}reverseBall(t){return t>0?-this.getRandom():this.getRandom()}goalProcess(t){t.score++,this.print.clear("score"),this.print.drawScore(),this.print.clear("text"),this.set.ballHitScore=0,this.print.drawGoal(t.goalPointX,t.color,t.align),this.game.reStart(t.align)}speed\u041Cagnifier(){this.ball.speed+=.1,this.set.ballHitScore++,this.print.clear("text"),this.print.drawBallHit()}defaultSet(){this.ball.x=this.set.ballXDefault,this.ball.y=this.set.ballYDefault,this.ball.speed=this.set.ballSpeed}draw(){this.print.drawBall()}update(){this.checkCollisionWithWalls(),this.move(),this.draw()}}class u{constructor(t,e){s(this,"set");s(this,"game");s(this,"player");s(this,"ball");s(this,"classBall");s(this,"print");s(this,"keyMap");s(this,"shadowUp");s(this,"shadowDown");s(this,"yellowZone");s(this,"ballReversStatus");s(this,"up");s(this,"down");s(this,"hitBall",(t,e)=>{this.ball.dx=this.classBall.reverseBall(t),e&&(this.ball.dy=this.classBall.reverseBall(e)),this.classBall.speed\u041Cagnifier(),this.ballReversStatus=!1,setTimeout(()=>{this.ballReversStatus=!0},500)});this.game=t,this.player=e,this.set=t.set,this.ball=t.set.ball,this.classBall=t.ball,this.print=t.print,this.keyMap=new Map(e.keys),document.addEventListener("keydown",i=>this.keyController(i,!0)),document.addEventListener("keyup",i=>this.keyController(i,!1)),this.shadowUp=0,this.shadowDown=0,this.yellowZone=!0,this.ballReversStatus=!0}keyController(t,e){this.keyMap.has(t.keyCode)&&(this[this.keyMap.get(t.keyCode)]=e)}move(){const t=this.set.playerHeight,e=this.set.playerSpeed,i=this.set.playerBorder,l=this.set.boxHeight;this.up?(this.player.y>i?this.player.y-=e:this.player.y=i,this.shadowUp=e*2):this.down?(this.player.y+t+i<l?this.player.y+=e:this.player.y=l-t-i,this.shadowDown=e*2):(this.shadowUp=0,this.shadowDown=0)}checkYellowZone(){const t=this.set.playerHeight;this.ball.y>this.player.y-this.shadowUp&&this.ball.y<this.player.y+t+this.shadowDown?this.yellowZone=!0:this.yellowZone=!1}checkCollisionWithBall(){const t=this.set.playerHeight;let e=this.ball.x-this.player.x,i=this.ball.y-(this.player.y-this.shadowUp),l=this.ball.y-(this.player.y+t+this.shadowDown),a=this.set.ballRadius+this.set.playerRadius,o=Math.sqrt(Math.pow(e,2)+Math.pow(i,2)),r=Math.sqrt(Math.pow(e,2)+Math.pow(l,2));Math.sqrt(Math.pow(e,2))<=a&&this.yellowZone&&this.ballReversStatus&&this.hitBall(this.ball.dx),this.ball.dy>0&&o<=a&&(this.yellowZone||this.hitBall(this.ball.dx,this.ball.dy)),this.ball.dy<0&&r<=a&&(this.yellowZone||this.hitBall(this.ball.dx,this.ball.dy))}defaultSet(){this.player.y=this.set.playerYDefault}draw(){let t=this.player.x,e=this.player.y,i=this.player.y+this.set.playerHeight;const l=this.player.color,a=this.set.playerRadius*2;this.print.drawPlayer(t,e,i,a,l)}update(){this.checkYellowZone(),this.checkCollisionWithBall(),this.move(),this.draw()}support(){let t=this.player.x,e=this.player.y-this.shadowUp,i=this.player.y+this.set.playerHeight+this.shadowDown;this.print.drawShadowPlayer(t,e,i),this.print.drawYellowZone(t,e,i)}}class n{constructor(t){s(this,"set");s(this,"canvas");s(this,"ctx");s(this,"drawText",(t,e,i,l,a=this.set.textColor,o="center",r="middle")=>{this.ctx&&(this.ctx.fillStyle=a,this.ctx.font=`bold ${l} 'Fira Mono', monospace`,this.ctx.textAlign=o,this.ctx.textBaseline=r,this.ctx.fillText(t,e,i))});var e;this.set=t,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.set.boxWidth,this.canvas.height=this.set.boxHeight,(e=document.querySelector("#game"))==null||e.appendChild(this.canvas)}drawLine(t,e,i,l,a,o){this.ctx&&(this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,l),this.ctx.lineWidth=a,this.ctx.strokeStyle=o,this.ctx.stroke(),this.ctx.closePath())}drawRectangleRound(t,e,i,l,a,o){this.ctx&&(this.ctx.beginPath(),this.ctx.moveTo(t+a,e),this.ctx.lineTo(t+i-a,e),this.ctx.quadraticCurveTo(t+i,e,t+i,e+a),this.ctx.lineTo(t+i,e+l-a),this.ctx.quadraticCurveTo(t+i,e+l,t+i-a,e+l),this.ctx.lineTo(t+a,e+l),this.ctx.quadraticCurveTo(t,e+l,t,e+l-a),this.ctx.lineTo(t,e+a),this.ctx.quadraticCurveTo(t,e,t+a,e),this.ctx.closePath(),this.ctx.fillStyle=o,this.ctx.fill())}drawCircle(t,e,i,l,a=!0){this.ctx&&(this.ctx.beginPath(),this.ctx.arc(t,e,i,0,Math.PI*2),this.ctx.fillStyle=l,this.ctx.fill(),a&&(this.ctx.lineWidth=6,this.ctx.strokeStyle=this.set.lineColor,this.ctx.stroke()),this.ctx.closePath())}drawArc(t,e,i,l=this.set.textColor){const a=this.set.boxWidth/2,o=this.set.boxHeight/2;this.ctx&&(this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.arc(a,o,t,e,i),this.ctx.lineWidth=6,this.ctx.strokeStyle=l,this.ctx.stroke(),this.ctx.closePath())}clear(){var t;(t=this.ctx)==null||t.clearRect(0,0,this.canvas.width,this.canvas.height)}}class C{constructor(t){s(this,"set");s(this,"ball");s(this,"canvas");s(this,"bgCan");s(this,"scoreCan");s(this,"supCan");s(this,"othCan");s(this,"txtCan");s(this,"gameCan");s(this,"ballDirectionAngle");this.set=t,this.ball=t.ball,this.canvas=new Map([["background",new n(this.set)],["score",new n(this.set)],["support",new n(this.set)],["other",new n(this.set)],["text",new n(this.set)],["gamelayer",new n(this.set)]]),this.bgCan=this.canvas.get("background"),this.scoreCan=this.canvas.get("score"),this.supCan=this.canvas.get("support"),this.othCan=this.canvas.get("other"),this.txtCan=this.canvas.get("text"),this.gameCan=this.canvas.get("gamelayer"),this.ballDirectionAngle=0}drawBackground(){const t=this.set.boxWidth,e=this.set.boxHeight,i=this.set.boxRound,l=this.set.boxColor,a=this.set.lineWidth,o=this.set.lineColor,r=this.set.playerSpace,d=this.set.playerBorder;this.bgCan.drawRectangleRound(0,0,t,e,i,l),this.bgCan.drawLine(t/2,0,t/2,e,a,o),this.bgCan.drawCircle(t/2,e/2,e/4,l),this.bgCan.drawLine(r,d,r,e-d,a,o),this.bgCan.drawLine(t-r,d,t-r,e-d,a,o)}drawBriefing(){const t=this.set.playerL.color,e=this.set.playerR.color,i=this.set.playerSpace*2,l=this.set.boxWidth-this.set.playerSpace*2,a=this.set.boxHeight/17;this.gameCan.drawText("keys:",i,a*8,"15px",t,"left"),this.gameCan.drawText("W and S",i,a*9,"20px",t,"left"),this.gameCan.drawText("keys:",l,a*8,"15px",e,"right"),this.gameCan.drawText("Arrows",l,a*9,"20px",e,"right")}drawScore(){const t=this.set.playerL.color,e=this.set.playerR.color,i=this.set.playerL.score,l=this.set.playerR.score,a=this.set.boxWidth/9*4,o=this.set.boxWidth/9*5,r=this.set.boxHeight/20;this.scoreCan.drawText(i.toString(),a,r,"40px",t,"right","top"),this.scoreCan.drawText(l.toString(),o,r,"40px",e,"left","top")}drawBallDirection(t=2){this.ball.dx>0&&this.ball.dy>0&&(this.ballDirectionAngle=6.3),this.ball.dx<0&&this.ball.dy>0&&(this.ballDirectionAngle=6.8),this.ball.dx<0&&this.ball.dy<0&&(this.ballDirectionAngle=7.3),this.ball.dx>0&&this.ball.dy<0&&(this.ballDirectionAngle=7.8),this.loopBallDirection(this.ballDirectionAngle-t)}loopBallDirection(t){const e=this.set.boxHeight/4;let i=t;this.othCan.drawArc(e,Math.PI*i-.3,Math.PI*i),setTimeout(()=>{i+=.1,i<=this.ballDirectionAngle&&(this.clear("other"),this.loopBallDirection(i))},60)}centerText(t,e="90px",i=this.set.textColor){const l=this.set.boxWidth/2,a=this.set.boxHeight/2;this.txtCan.drawText(t,l,a,e,i)}drawBallHit(){this.centerText(this.set.ballHitScore.toString(),"70px",this.set.lineColor)}drawGoal(t,e,i){this.txtCan.drawText("+1",t,this.ball.y,"20px",e,i),this.centerText("Goal!","50px",e),setTimeout(()=>{this.clear("text")},800)}drawBall(){let t=this.ball.x,e=this.ball.y,i=this.set.ballRadius,l=this.set.ballColor;this.gameCan.drawCircle(t,e,i,l,!1)}drawPlayer(t,e,i,l,a){this.gameCan.drawLine(t,e,t,i,l,a)}drawShadowPlayer(t,e,i){if(this.set.drawYellow){const l=this.set.supportColorYellow,a=this.set.playerRadius*2;this.supCan.drawLine(t,e,t,i,a,l)}}drawYellowZone(t,e,i){if(this.set.drawYellow){const l=this.set.supportColorYellow,a=this.set.boxWidth/2;this.supCan.drawLine(t,e,a,e,1,l),this.supCan.drawLine(t,i,a,i,1,l)}}drawAngleZone(){const t=this.set.supportColorRed,e=this.set.boxHeight/4;this.supCan.drawArc(e,Math.PI*.2,Math.PI*.3,t),this.supCan.drawArc(e,Math.PI*.7,Math.PI*.8,t),this.supCan.drawArc(e,Math.PI*1.2,Math.PI*1.3,t),this.supCan.drawArc(e,Math.PI*1.7,Math.PI*1.8,t)}clear(t){var e;(e=this.canvas.get(t))==null||e.clear()}}class m{constructor(){s(this,"set");s(this,"print");s(this,"ball");s(this,"playerL");s(this,"playerR");s(this,"reqId");s(this,"openPause");s(this,"start",t=>{t&&(this.reqId=!!requestAnimationFrame(e=>this.timeLoop(e)))});s(this,"timeLoop",()=>{this.openPause||(this.print.clear("gamelayer"),this.ball.update(),this.playerL.update(),this.playerR.update(),this.support(),this.start(this.reqId))});this.set=new w,this.print=new C(this.set),this.ball=new f(this),this.playerL=new u(this,this.set.playerL),this.playerR=new u(this,this.set.playerR),this.reqId=!0,this.firstLaunch(),this.openPause=!1}firstLaunch(){this.print.drawBackground(),this.support(),this.playerL.draw(),this.playerR.draw(),this.print.drawScore(),this.print.drawBriefing(),this.ball.dropBall(),this.print.drawBallDirection(4),this.print.centerText("3"),setTimeout(()=>{this.print.clear("text"),this.print.centerText("2")},800),setTimeout(()=>{this.print.clear("text"),this.print.centerText("1")},1600),setTimeout(()=>{this.print.clear("text"),this.print.centerText("Go")},2400),setTimeout(()=>{this.print.clear("text"),this.print.clear("other"),this.start(this.reqId)},3200)}reStart(t){this.reqId=!1,setTimeout(()=>{this.print.clear("gamelayer"),this.playerL.defaultSet(),this.playerR.defaultSet(),this.ball.defaultSet(),this.playerL.draw(),this.playerR.draw(),this.ball.draw(),this.support(),this.ball.dropBall(t),this.print.drawBallDirection()},800),setTimeout(()=>{this.print.clear("other"),this.reqId=!0,this.start(this.reqId)},2400)}continue(){this.start(this.reqId)}pauseToggle(){this.openPause=!this.openPause,this.openPause||this.continue()}support(){this.print.clear("support"),this.playerL.support(),this.playerR.support(),this.print.drawAngleZone()}}let p;const c=document.getElementById("game"),b=()=>{const h=document.getElementById("setting");h&&(c==null||c.removeChild(h))},B=()=>{if(p.openPause)b();else{const h=document.createElement("div");h.id="setting",h.innerHTML=g,c==null||c.appendChild(h);const t=document.getElementById("continue"),e=document.getElementById("changeBackgroundColor");t&&(t.onclick=()=>{b(),p.pauseToggle()}),e&&(e.onclick=()=>{console.log("Open color picker")})}};window.onload=()=>{p=new m};document.addEventListener("keydown",h=>{h.code==="Escape"&&(B(),p.pauseToggle())});
